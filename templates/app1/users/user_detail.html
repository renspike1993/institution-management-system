{% extends "base.html" %}
{% block title %}User Details{% endblock %}
{% block content %}

<!-- Header -->
<div class="flex items-center p-3 my-3 text-white bg-purple-600 rounded-md shadow">
    <i class="fas fa-user text-3xl mr-3"></i>
    <div>
        <h1 class="text-base font-semibold leading-tight">User Details</h1>
        <small class="text-purple-200 text-xs">{{ user_obj.first_name }} {{ user_obj.last_name }}</small>
    </div>
</div>

<!-- User Info Card -->
<div class="bg-white shadow rounded-lg p-5 mb-6">
    <h2 class="text-base font-semibold mb-3 text-gray-700">User Information</h2>
    <div class="space-y-1.5 text-gray-700 text-sm">
        <p><strong>Username:</strong> {{ user_obj.username }}</p>
        <p><strong>Full Name:</strong> {{ user_obj.first_name }} {{ user_obj.last_name }}</p>
        <p><strong>Email:</strong> {{ user_obj.email }}</p>
        <p><strong>Date Joined:</strong> {{ user_obj.date_joined|date:"Y-m-d H:i" }}</p>
        <p><strong>Last Login:</strong> {% if user_obj.last_login %}{{ user_obj.last_login|date:"Y-m-d H:i" }}{% else %}-{% endif %}</p>
    </div>

    <!-- Action Buttons -->
    <div class="flex justify-end mt-4 gap-2">
        <a href="{% url 'update_user' user_obj.id %}" class="px-3 py-1.5 bg-yellow-500 text-white rounded hover:bg-yellow-600 text-xs flex items-center">
            <i class="fas fa-edit mr-1 text-xs"></i> Edit
        </a>
        <a href="{% url 'delete_user' user_obj.id %}" class="px-3 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 text-xs flex items-center">
            <i class="fas fa-trash mr-1 text-xs"></i> Delete
        </a>
    </div>
</div>
<h2 class="text-base font-semibold text-gray-700 mt-6 mb-2.5">Transactions History</h2>

<!-- Transactions -->
{% if transactions %}
<div class="overflow-x-auto">
    <table class="min-w-full divide-y divide-gray-300 text-sm">
        <thead class="bg-gray-100">
            <tr>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Book</th>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Reserved</th>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Borrowed</th>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Due</th>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Returned</th>
                <th class="px-3 py-2 text-left text-[10px] font-semibold">Status</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-gray-200 bg-white">
            {% for t in transactions %}
            <tr>
                <td class="px-3 py-2">{{ t.book.title }}</td>
                <td class="px-3 py-2">{{ t.date_reserve|date:"Y-m-d" }}</td>
                <td class="px-3 py-2">{% if t.date_borrowed %}{{ t.date_borrowed|date:"Y-m-d H:i" }}{% else %}-{% endif %}</td>
                <td class="px-3 py-2">{% if t.due_date %}{{ t.due_date|date:"Y-m-d" }}{% else %}-{% endif %}</td>
                <td class="px-3 py-2">{% if t.date_returned %}{{ t.date_returned|date:"Y-m-d" }}{% else %}-{% endif %}</td>
                <td class="px-3 py-2">
                    <span class="px-2 py-1 rounded text-xs font-semibold
                        {% if t.status == 'borrowed' %}bg-blue-100 text-blue-700
                        {% elif t.status == 'returned' %}bg-green-100 text-green-700
                        {% elif t.status == 'overdue' %}bg-red-100 text-red-700
                        {% else %}bg-gray-100 text-gray-700{% endif %}">
                        {{ t.status|title }}
                    </span>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% else %}

<div class="text-center py-12 text-gray-500 space-y-2">
    <i class="fas fa-folder-open text-4xl text-gray-300"></i>
    <p>No transactions found for this user.</p>
{% endif %}

{% endblock %}
